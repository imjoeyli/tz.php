<!DOCTYPE html>
<meta charset="utf-8">
<title>phus.lu</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noindex, nofollow">
<style>
html {
	scroll-behavior: smooth;
}
body {
	margin: 0;
	font-family: "Helvetica Neue", "Luxi Sans", "DejaVu Sans", Tahoma, "Hiragino Sans GB", "Microsoft Yahei", sans-serif;
}
.container {
	padding-right: 15px;
	padding-left: 15px;
	margin-right: auto;
	margin-left: auto;
}
@media(min-width:768px) {
	.container {
		max-width: 750px;
	}
}
@media(min-width:992px) {
	.container {
		max-width: 970px;
	}
}
@media(min-width:1200px) {
	.container {
		max-width: 1170px;
	}
}
</style>

<div class="container">

<table></table>

<table>
	<tr>
	<th colspan="4">Server Information</th>
	</tr>
	<tr>
	<td>Hostname</td>
	<td colspan="3">sg(203.24.92.159)&nbsp;&nbsp;&nbsp;
		Client Infomation:
		<span id="remoteip">154.31.116.28</span>
		<span id="iploc"></span>
	</td>
	</tr>
	<tr>
	<td>Uname</td>
	<td colspan="3">Linux sg 5.10.0-10-amd64 #1 SMP Debian 5.10.84-1 (2021-12-08) x86_64</td>
	</tr>
	<tr>
	<td>OS</td>
	<td>Debian GNU/Linux 11 (bullseye)</td>
	<td>Language</td>
	<td>en_US.UTF-8</td>
	</tr>
	<tr>
	<td>Server Software</td>
	<td>nginx/1.18.0 php/7.4.25</td>
	<td>Server Port</td>
	<td>80</td>
	</tr>
	<tr>
	<td>Prober Path</td>
	<td colspan="3">/home/phuslu/web/tz.php</td>
	</tr>
</table>

<table>
	<tr>
	<th colspan="4">Server Realtime Data</th>
	</tr>
	<tr>
	<td>Time</td>
	<td><span id="stime">2022-01-12 19:12:01</span></td>
	<td>Uptime</td>
	<td><span id="uptime">5 days 19 hours 3 minutes </span></td>
	</tr>
	<tr>
	<td>CPU Model [4x]</td>
	<td colspan="3">
		Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz		| Frequency: 2099.998 MHz
		| L2 Cache：16384 KB		| Bogomips: 4199.99 ×4	</td>
	</tr>
	<tr>
	<td>CPU Instruction Set</td>
	<td colspan="3" style="word-wrap: break-word;width: 64em;">fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon rep_good nopl xtopology cpuid tsc_known_freq pni pclmulqdq vmx ssse3 fma cx16 pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch cpuid_fault invpcid_single ssbd ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid mpx avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves arat umip pku ospke avx512_vnni md_clear arch_capabilities</td>
	</tr>
	<tr>
	<td>BIOS Version</td>
	<td>SeaBIOS 04/01/2014</td>
	<td>Board Vendor</td>
	<td>KVM  </td>
	</tr>
	<tr>
	<td>CPU Usage</td>
	<td colspan="3">
	<span id="stat_user" class="text-info">0.0</span> user,
	<span id="stat_sys" class="text-info">0.0</span> sys,
	<span id="stat_nice">0.0</span> nice,
	<span id="stat_idle" class="text-info">99.9</span> idle,
	<span id="stat_iowait">0.0</span> iowait,
	<span id="stat_irq">0.0</span> irq,
	<span id="stat_softirq">0.0</span> softirq,
	<span id="stat_steal">0.0</span> steal
	<div class="progress">
	<div id="stat_UserBar" class="progress-bar progress-bar-success" role="progressbar" style="width:1px" ></div>
	<div id="stat_SystemBar" class="progress-bar progress-bar-warning" role="progressbar" style="width:0px" ></div>
	</div>
	</td>
	</tr>
	<tr>
	<td>Memory Usage</td>
	<td colspan="3">
	Physical Memory <span id="meminfo_Total" class="text-info">5.802 G </span>
	, Used <span id="meminfo_Used" class="text-info">794.14 M</span>
	, Cached <span id="meminfo_Buffers" class="text-info">83.96 M</span>
	/ <span id="meminfo_Cached" class="text-info">1.669 G</span>
	, Free <span id="meminfo_Free" class="text-info">3.275 G</span>
	, Percent <span id="meminfo_UsedPercent">13.37</span>%<br>
	<div class="progress">
	<div id="meminfo_UsedBar" class="progress-bar progress-bar-warning" role="progressbar" style="width:13.37%" ></div>
	<div id="meminfo_BuffersBar" class="progress-bar progress-bar-info" role="progressbar" style="width:1.41%" ></div>
	<div id="meminfo_CachedBar" class="progress-bar progress-bar-success" role="progressbar" style="width:28.77%" ></div>
	</div>
	SWAP：<span id="meminfo_swapTotal">3 G</span>
	, Used <span id="meminfo_swapUsed">36.18 M</span>
	, Free <span id="meminfo_swapFree">2.965 G</span>
	, Percent <span id="meminfo_swapPercent">1.18</span>%
	<div class="progress"><div id="meminfo_swapBar" class="progress-bar progress-bar-danger" role="progressbar" style="width:1.18%" ></div> </div>
	</td>
	</tr>
	<tr>
	<td>Disk Usage</td>
	<td colspan="3">
	Total Space 2044.86&nbsp;G，
	Used <span id="diskinfo_Used">351.52</span>&nbsp;G，
	Free <span id="diskinfo_Free">1693.34</span>&nbsp;G，
	Percent <span id="diskinfo_Percent">17.19</span>%
	<div class="progress"><div id="diskinfo_UsedBar" class="progress-bar progress-bar-black" role="progressbar" style="width:17.19%" ></div> </div>
	</td>
	</tr>
	<tr>
	<td>Loadavg</td>
	<td colspan="3" class="text-danger"><span id="loadAvg">0.00 0.00 0.00 1/286</span></td>
	</tr>
	<td>Sockets</td>
	<td colspan="3"><span id="sockets">183</span></td>
	</tr>
</table>

<table class="table table-striped table-bordered table-hover table-condensed">
	<tr><th colspan="5">Network Usage</th></tr>
	<tr>
	<td style="width:13%">lo : </td>
	<td style="width:29%">Rx: <span class="text-info" id="netdev_lo_human_rx">923 M 864 K 565 B </span></td>
	<td style="width:14%">Realtime: <span class="text-info" id="netdev_lo_delta_rx">0B/s</span></td>
	<td style="width:29%">Tx: <span class="text-info" id="netdev_lo_human_tx">923 M 864 K 565 B </span></td>
	<td style="width:14%">Realtime: <span class="text-info" id="netdev_lo_delta_tx">0B/s</span></td>
	</tr>
	<tr>
	<td style="width:13%">eth0 : </td>
	<td style="width:29%">Rx: <span class="text-info" id="netdev_eth0_human_rx">28 G 740 M 353 K 168 B </span></td>
	<td style="width:14%">Realtime: <span class="text-info" id="netdev_eth0_delta_rx">0B/s</span></td>
	<td style="width:29%">Tx: <span class="text-info" id="netdev_eth0_human_tx">16 G 143 M 312 K 16 B </span></td>
	<td style="width:14%">Realtime: <span class="text-info" id="netdev_eth0_delta_tx">0B/s</span></td>
	</tr>
</table>

<table class="table table-striped table-bordered table-hover table-condensed">
	<tr><th colspan="5">Network Neighborhood</th></tr>
	<tr>
	<td>195.85.19.2 </td>
	<td>MAC: <span class="text-info">98:5d:82:24:ef:d9</span></td>
	<td>Type: <span class="text-info">ether</span></td>
	<td>Device: <span class="text-info">eth0</span></td>
	</tr>
	<tr>
	<td>195.85.19.3 </td>
	<td>MAC: <span class="text-info">98:5d:82:24:ec:cd</span></td>
	<td>Type: <span class="text-info">ether</span></td>
	<td>Device: <span class="text-info">eth0</span></td>
	</tr>
	<tr>
	<td>203.24.92.1 </td>
	<td>MAC: <span class="text-info">00:1c:73:03:01:01</span></td>
	<td>Type: <span class="text-info">ether</span></td>
	<td>Device: <span class="text-info">eth0</span></td>
	</tr>
</table>

<table class="table table-striped table-bordered table-hover table-condensed">
	<tr><th colspan="12"><a href="?method=phpinfo">PHP Information</a></th></tr>
	<tr>
	<td style="width:16.7%">Version</td><td>7.4.25</td>
	<td style="width:16.7%">Zend OpCache</td><td>On</td>
	</tr>
	<tr>
	<td style="width:16.7%">Server API</td><td>fpm-fcgi</td>
	<td style="width:16.7%">Memory Limit</td><td>128M</td>
	</tr>
	<tr>
	<td style="width:16.7%">POST Max Size</td><td>8M</td>
	<td style="width:16.7%">Upload Max FileSize</td><td>2M</td>
	</tr>
	<tr>
	<td style="width:16.7%">Max Execution Time</td><td>30s</td>
	<td style="width:16.7%">Default Socket Timeout</td><td>60s</td>
	</tr>
	<tr>
	<td style="width:16.7%">PHP Extension</td>
	<td colspan="9">Core date libxml openssl pcre zlib filter hash Reflection SPL session standard sodium cgi-fcgi PDO calendar ctype exif FFI fileinfo ftp gettext iconv json Phar posix readline shmop sockets sysvmsg sysvsem sysvshm tokenizer Zend OPcache</td>
	</tr>
</table>

<table class="table table-striped table-bordered table-hover table-condensed">
	<tr>
	<td>PHP Prober(<a href="https://phus.lu/tz.php?method=raw">Turbo Version</a>) v1.0</td>
	<td>Processed in 1.0 ms, 364 KB memory usage.</td>
	<td><a href="javascript:scroll(0,0)">Back to top</a></td>
	</tr>
</table>

</div>

<style>
table {
	width: 100%;
	max-width: 100%;
	margin-bottom: 20px;
	border: 1px solid #ddd;
	padding: 0;
	border-collapse: collapse;
}
table th {
	font-size: 14px;
}
table tr {
	border: 1px solid #ddd;
	padding: 5px;
}
table tr:nth-child(odd) {
	background: #f9f9f9
}
table th, table td {
	border: 1px solid #ddd;
	font-size: 14px;
	line-height: 20px;
	padding: 3px;
	text-align: left;
}
table.table-hover > tbody > tr:hover > td,
table.table-hover > tbody > tr:hover > th {
	background-color: #f5f5f5;
}
a {
	color: #337ab7;
	text-decoration: none;
}
a:hover, a:focus {
	color: #2a6496;
	text-decoration: underline;
}
.text-info {
	color: #3a87ad;
}
.text-danger {
	color: #b94a48;
}
.progress {
	height:10px;
	width:90%;
	margin-bottom: 20px;
	overflow: hidden;
	background-color: #f5f5f5;
	border-radius: 4px;
	box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
	float: left;
	width: 0;
	height: 100%;
	font-size: 12px;
	color: #ffffff;
	text-align: center;
	background-color: #428bca;
	box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
	transition: width 0.6s ease;
	background-size: 40px 40px;
}
.progress-bar-success {
	background-color: #5cb85c;
}
.progress-bar-info {
	background-color: #5bc0de;
}
.progress-bar-warning {
	background-color: #f0ad4e;
}
.progress-bar-danger {
	background-color: #d9534f;
}
.progress-bar-black {
	background-color: #333;
}
</style>

<script type="text/javascript">
var dom = {
	element: null,
	get: function (o) {
		function F() { }
		F.prototype = this
		obj = new F()
		obj.element = (typeof o == "object") ? o : document.createElement(o)
		return obj
	},
	width: function (w) {
		if (!this.element)
			return
		this.element.style.width = w
		return this
	},
	html: function (h) {
		if (!this.element)
			return
		this.element.innerHTML = h
		return this
	}
};

$ = function(s) {
	return dom.get(document.getElementById(s.substring(1)))
};

$.getData = function (url, f) {
	var xhr = new XMLHttpRequest();
	xhr.open('GET', url, true)
	xhr.onreadystatechange = function() {
		if (xhr.readyState == 4 && xhr.status == 200) {
			f(xhr.responseText)
		}
	}
	xhr.send()
}

$.getJSON = function (url, f) {
	var xhr = new XMLHttpRequest();
	xhr.open('GET', url, true)
	xhr.onreadystatechange = function() {
		if (xhr.readyState == 4 && xhr.status == 200) {
			if (window.JSON) {
				f(JSON.parse(xhr.responseText))
			} else {
				f((new Function('return ' + xhr.responseText))())
			}
		}
	}
	xhr.send()
}

var stat = ["558790","151","409645","198162841","74404","0","381284","112928","0","0"];
var netdev = {"lo":{"ts":1641985921806,"rx":968720949,"human_rx":"923 M 864 K 565 B ","tx":968720949,"human_tx":"923 M 864 K 565 B "},"eth0":{"ts":1641985921806,"rx":30841078952,"human_rx":"28 G 740 M 353 K 168 B ","tx":17330135056,"human_tx":"16 G 143 M 312 K 16 B "}};

function getSysinfo() {
	$.getJSON('?method=sysinfo', function (data) {
		$('#uptime').html(data.uptime)
		$('#stime').html(data.stime)

		if (data.tempinfo.cpu)
			$('#cpu_temp').html(data.tempinfo.cpu+' ℃')
		if (data.tempinfo.gpu)
			$('#gpu_temp').html(data.tempinfo.gpu+' ℃')

		stat_total = 0
		for (var i = 0; i < data.stat.length; i++) {
			stat[i] = data.stat[i] - stat[i]
			stat_total += stat[i]
		}
		$("#stat_user").html((100*stat[0]/stat_total).toFixed(1))
		$("#stat_nice").html((100*stat[1]/stat_total).toFixed(1))
		$("#stat_sys").html((100*stat[2]/stat_total).toFixed(1))
		$("#stat_idle").html((100*stat[3]/stat_total).toFixed(1).substring(0,4))
		$("#stat_iowait").html((100*stat[4]/stat_total).toFixed(1))
		$("#stat_irq").html((100*stat[5]/stat_total).toFixed(1))
		$("#stat_softirq").html((100*stat[6]/stat_total).toFixed(1))
		$("#stat_steal").html((100*stat[7]/stat_total).toFixed(1))
		$("#stat_UserBar").width(100 * (stat[0]+stat[1])/stat_total+'%')
		$("#stat_SystemBar").width((100 * (stat_total-stat[0]-stat[1]-stat[3])/stat_total)+'%')
		stat = data.stat

		$('#meminfo_Total').html(data.meminfo.memTotal)
		$('#meminfo_Used').html(data.meminfo.memUsed)
		$('#meminfo_Free').html(data.meminfo.memFree)
		$('#meminfo_UsedPercent').html(data.meminfo.memUsedPercent)
		$('#meminfo_UsedBar').width(data.meminfo.memUsedPercent)
		$('#meminfo_BuffersBar').width(data.meminfo.memBuffersPercent)
		$('#meminfo_CachedBar').width(data.meminfo.memCachedPercent)

		$('#meminfo_swapTotal').html(data.meminfo.swapTotal)
		$('#meminfo_swapUsed').html(data.meminfo.swapUsed)
		$('#meminfo_swapFree').html(data.meminfo.swapFree)
		$('#meminfo_swapPercent').html(data.meminfo.swapPercent)
		$('#meminfo_swapBar').width(data.meminfo.swapPercent)

		$('#diskinfo_Used').html(data.diskinfo.diskUsed)
		$('#diskinfo_Free').html(data.diskinfo.diskFree)
		$('#diskinfo_Percent').html(data.diskinfo.diskPercent)
		$('#diskinfo_UsedBar').width(data.diskinfo.diskPercent)

		$('#loadAvg').html(data.loadavg)
		$('#sockets').html(data.sockstat.sockets.used)

		for (var dev in netdev) {
			var info = netdev[dev]
			$('#netdev_'+ dev + '_human_rx').html(data.netdev[dev].human_rx)
			$('#netdev_'+ dev + '_human_tx').html(data.netdev[dev].human_tx)
			$('#netdev_'+ dev + '_delta_rx').html(((data.netdev[dev].rx - info.rx)/(data.netdev[dev].ts - info.ts)).toFixed(2) + 'K/s')
			$('#netdev_'+ dev + '_delta_tx').html(((data.netdev[dev].tx - info.tx)/(data.netdev[dev].ts - info.ts)).toFixed(2) + 'K/s')
		}
		netdev = data.netdev
	});
}

function getIploc() {
	$.getData('https://ip.phus.lu/', function (data) {
		remoteip = document.getElementById('remoteip').innerText
		ip = data.match(/\d+\.\d+\.\d+\.\d+/)[0]
		iploc = data.substring(ip.length+2)
		if (ip !== remoteip) {
			$("#iploc").html('(检测到分流代理，'+ data + ')')
		} else {
			$("#iploc").html('('+iploc+')')
		}
	})
}

window.onload = function() {
	setTimeout(getIploc, 0)
	setInterval(getSysinfo, 1000)
}

</script>

